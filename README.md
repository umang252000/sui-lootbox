# ğŸ“¦ Sui Loot Box System with On-Chain Randomness

A fully on-chain Loot Box System built on Sui blockchain using the Move language, featuring verifiable randomness, NFT rewards, and a pity system that guarantees a Legendary item after repeated unlucky attempts.

This project was built for the Sui Move Smart Contract Hackathon â€“ Gaming Track.

---

## ğŸ“‘ Table of Contents

- [Overview](#-overview)
- [Key Features](#-key-features)
- [Architecture](#-architecture)
- [Rarity System](#-rarity-system)
- [On-Chain Randomness](#-on-chain-randomness)
- [Pity System (Bonus Feature)](#-pity-system-bonus-feature)
- [Smart Contract Components](#-smart-contract-components)
- [Functions Implemented](#-functions-implemented)
- [Testing](#-testing)
- [Deployment](#-deployment)
- [Demo Flow](#-demo-flow)
- [Security Considerations](#-security-considerations)
- [Future Improvements](#-future-improvements)
- [Conclusion](#-conclusion)

---

## Overview

Loot boxes are a common game mechanic where users purchase a mystery box and receive a random reward.  
In Web3 gaming, fairness and transparency are critical.

This project implements:

- On-chain randomness using Suiâ€™s validator-driven randomness beacon  
- NFT-based in-game items  
- Provably fair rarity distribution  
- A per-user pity system to improve player experience  

All logic is executed fully on-chain, making the system trustless, transparent, and verifiable.

---

## âœ¨ Key Features

- ğŸ Purchase unopened loot boxes using SUI  
- ğŸ² Open loot boxes using secure on-chain randomness  
- Mint unique NFT game items  
- â­ Multiple rarity tiers (Common â†’ Legendary)  
- ğŸ” Transfer NFTs between users  
- ğŸ”¥ Burn unwanted NFTs  
- Admin-controlled rarity balancing  
- ğŸ’ Pity system guaranteeing a Legendary after 30 non-legendary opens (bonus)  

---

## Architecture

The system follows Suiâ€™s object-oriented model:

```bash

User
â”œâ”€ buys LootBox (owned object)
â”œâ”€ opens LootBox (entry function)
â”‚ â”œâ”€ randomness generated on-chain
â”‚ â”œâ”€ rarity decided
â”‚ â”œâ”€ GameItem NFT minted
â”‚ â”œâ”€ LootBox burned
â”‚ â””â”€ Event emitted
â””â”€ owns / transfers / burns GameItem

```
---

## â­ Rarity System

Each loot box open generates a random number between `0â€“99`.

| Rarity      | Probability | Power Range |
|------------|------------|-------------|
| Common     | 60%        | 1 â€“ 10      |
| Rare       | 25%        | 11 â€“ 25     |
| Epic       | 12%        | 26 â€“ 40     |
| Legendary  | 3%         | 41 â€“ 50     |

This distribution is fully on-chain and verifiable.

---

## ğŸ² On-Chain Randomness

The contract uses Suiâ€™s native randomness module:

- Randomness is generated by validators  
- Cannot be predicted or manipulated by users or developers  
- Generator is created inside the entry function as required  

This ensures:

- Fair gameplay  
- Transparent reward logic  
- Resistance to manipulation  

---

## ğŸ’ Pity System (Bonus Feature)

To improve player experience, a pity system is implemented:

- Each user has a counter tracking opens without a Legendary  
- If a user opens 30 loot boxes without a Legendary  
- The next loot box is guaranteed Legendary  

**Implementation Details:**

- Stored per user using Sui Dynamic Fields  
- Fully on-chain and transparent  
- Counter resets after a Legendary drop  

This feature demonstrates advanced Sui concepts and strong game economy design.

---

## Smart Contract Components

### Core Objects

- **GameConfig (shared)**  
  Stores loot box price and rarity weights  

- **LootBox (owned)**  
  Represents an unopened loot box  

- **GameItem (NFT)**  
  In-game item with name, rarity, and power  

- **AdminCap (capability)**  
  Restricts admin-only functions  

- **PityCounter (dynamic field)**  
  Tracks unlucky streak per user  

---

## Functions Implemented

### Required Functions

- `init_game`  
- `purchase_loot_box`  
- `open_loot_box`  
- `get_item_stats`  
- `transfer_item`  
- `burn_item`  
- `update_rarity_weights`  

### Bonus

- Pity system logic integrated into `open_loot_box`  

---

## Testing

Unit tests are provided in the `tests/` folder and cover:

- Game initialization  
- Loot box purchase flow  
- NFT metadata correctness  

Randomness-dependent logic is validated via on-chain execution and event inspection, which is the correct approach for non-deterministic systems.

Run tests using:

```bash
sui move test
```

## ğŸš€ Deployment

The contract is deployed to Sui Testnet.

Deployment steps:
```bash
sui move build
sui client publish --gas-budget 300000000
```

#### Deployment outputs:

- Package ID
- Shared GameConfig object
- AdminCap owned by deployer

## ğŸ® Demo Flow

- 1. Buy loot box
- 2. Open loot box
- 3. Observe randomness-based NFT mint
- 4. View NFT stats
- 5. Transfer or burn NFT

This flow demonstrates end-to-end functionality.

## ğŸ” Security Considerations

- Randomness is generated on-chain and cannot be influenced
- Admin actions require AdminCap ownership
- Payment validation prevents incorrect pricing
- Objects are properly consumed or deleted to avoid state leaks

## ğŸ”® Future Improvements

- Frontend UI for players
- Multiple loot box types
- Secondary marketplace integration
- Seasonal rarity adjustments
- On-chain analytics for drop rates

## ğŸ Conclusion

This project demonstrates:

- Correct and secure use of Sui Move
- Proper handling of on-chain randomness
- Strong understanding of NFTs and object lifecycle
- Advanced concepts like dynamic fields and pity systems

It provides a fair, transparent, and scalable foundation for Web3 gaming on Sui.
